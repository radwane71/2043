<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<link rel="icon" href="data:,">
<title>ุงูุฅุนุฏุงุฏุงุช โ 2043</title>
<link rel="stylesheet" href="assets/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="assets/tickers.js"></script>
<script src="assets/data.js"></script>
<script src="assets/auth.js"></script>
</head>
<body>
<script>initPage('settings');</script>

<div class="main">

  <div class="page-header">
    <div class="page-header-left">
      <h1>โ๏ธ ุงูุฅุนุฏุงุฏุงุช ูุงููุชุบูุฑุงุช</h1>
      <p>ุชุญูู ูุงูู ูู ูู ูุนุงููุงุช ุงููููุน โ ุงูุชุบููุฑุงุช ุชูุนูุณ ููุฑุงู ุนูู ูู ุงูุตูุญุงุช</p>
    </div>
    <div class="page-header-right">
      <button class="btn btn-danger btn-sm" onclick="resetAll()">๐ ุงุณุชุนุงุฏุฉ ุงูุงูุชุฑุงุถู</button>
      <button class="btn btn-primary"       onclick="saveAll()">๐พ ุญูุธ ุงููู</button>
    </div>
  </div>

  <!-- โโ 1. ุฅุนุฏุงุฏุงุช ุนุงูุฉ โโ -->
  <div class="settings-section">
    <div class="settings-section-header">๐ค ุฅุนุฏุงุฏุงุช ุนุงูุฉ</div>
    <div class="settings-section-body">
      <div class="setting-row">
        <div class="setting-row-info"><label>ุงุณู ุงููุงูู</label><small>ูุธูุฑ ูู ุงูู Sidebar</small></div>
        <input type="text" id="s-ownerName">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุณูุฉ ุงูุชูุงุนุฏ ุงููุณุชูุฏูุฉ</label><small>ุงููุญูุฑ ุงูุฒููู ุงูุฑุฆูุณู</small></div>
        <input type="number" id="s-retirementYear">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุฑุฃุณ ุงููุงู ุงููุณุชูุฏู (SAR)</label><small>ูุฏู ุตุงูู ุงูุซุฑูุฉ ุงููุงูู</small></div>
        <input type="number" id="s-targetCapital">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุนุงุฆุฏ ุงูุชูุฒูุนุงุช ุงููุณุชูุฏู %</label><small>ุงููุณุจุฉ ุงูุณูููุฉ ุงููุทููุจุฉ</small></div>
        <input type="number" id="s-targetYield" step="0.01">
      </div>
    </div>
  </div>

  <!-- โโ 2. ุงูุนูููุงุช ูุงูุถุฑุงุฆุจ โโ -->
  <div class="settings-section">
    <div class="settings-section-header">๐ธ ุงูุนูููุงุช ูุงูุถุฑุงุฆุจ</div>
    <div class="settings-section-body">
      <div class="setting-row">
        <div class="setting-row-info"><label>ูุณุจุฉ ุนูููุฉ ุงูุชุฏุงูู %</label><small>ุชุทุจู ุนูู ูู ุนูููุฉ</small></div>
        <input type="number" id="s-commissionRate" step="0.00001">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ูุณุจุฉ VAT ุนูู ุงูุนูููุฉ %</label><small>ุถุฑูุจุฉ ุงููููุฉ ุงููุถุงูุฉ</small></div>
        <input type="number" id="s-vatRate" step="0.01">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุงูุญุฏ ุงูุฃุฏูู ููุนูููุฉ (SAR)</label><small>0 = ูุง ููุฌุฏ ุญุฏ ุฃุฏูู</small></div>
        <input type="number" id="s-minCommission" step="0.01">
      </div>
    </div>
  </div>

  <!-- โโ 3. ููุงุนุฏ ุงููุญูุธุฉ โโ -->
  <div class="settings-section">
    <div class="settings-section-header">๐ ููุงุนุฏ ุงููุญูุธุฉ</div>
    <div class="settings-section-body">
      <div class="setting-row">
        <div class="setting-row-info"><label>ุฃูุตู ุชุฎุตูุต ูุณูู ูุงุญุฏ %</label><small>ุชุฌุงูุฒู = ุชุฑููุฒ ูุฑุชูุน</small></div>
        <input type="number" id="s-maxPositionPct" step="0.01">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุฃูุตู ุชุฎุตูุต ููุทุงุน ูุงุญุฏ %</label><small>ุญูุงูุฉ ูู ุชุฑููุฒ ุงููุทุงุน</small></div>
        <input type="number" id="s-maxSectorPct" step="0.01">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุฃูุตู ุชุฎุตูุต ููุจูู ุดูุจ %</label><small>ุฃุฑุงููู / STC</small></div>
        <input type="number" id="s-blueChipMaxPct" step="0.01">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงููุฑุงูุฒ</label><small>ุชูููุน ูุงูู</small></div>
        <input type="number" id="s-minPositions">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงููุฑุงูุฒ</label><small>ูุชุฌูุจ ุงูุชุดุชุช</small></div>
        <input type="number" id="s-maxPositions">
      </div>
      <div class="setting-row">
        <div class="setting-row-info"><label>ุนุชุจุฉ ุฅุนุงุฏุฉ ุงูุชูุงุฒู %</label><small>ุชูุงูุช ููุจูู ูุจู ุฅุนุงุฏุฉ ุงูุชูุงุฒู</small></div>
        <input type="number" id="s-rebalanceThresh" step="0.01">
      </div>
    </div>
  </div>

  <!-- โโ 4. ุฅุนุฏุงุฏุงุช ุงูุฃุณูู โโ -->
  <div class="settings-section">
    <div class="settings-section-header">๐ ุฅุนุฏุงุฏุงุช ุงูุฃุณูู โ ููุงุทู ุงูุดุฑุงุก ูุงูุจูุน ูุงููุฏู</div>
    <div class="settings-section-body">
      <div class="info-box blue" style="margin-bottom:16px">
        ูุฐู ุงูุจูุงูุงุช ูุฑุจูุทุฉ ูุจุงุดุฑุฉ ุจุตูุญุฉ ุงููุญูุธุฉ. ุงูุชุนุฏูู ููุง ูุญุฏูุซ ุงูุฌุฏูู ุงูุฑุฆูุณู ููุฑุงู ุนูุฏ ุงูุญูุธ.
      </div>
      <div style="overflow:auto">
        <table style="min-width:900px">
          <thead>
            <tr>
              <th>ุงูุณูู</th><th>ุงูุชููุฑ</th><th>ุงููุฏู %</th>
              <th>ุดุฑุงุก &lt;</th><th>ุจูุน ูู</th><th>ุจูุน ุฅูู</th>
              <th>ุงููุฑุงุฑ</th><th>ุงูุชูููู</th>
            </tr>
          </thead>
          <tbody id="stocksSettingsBody"></tbody>
        </table>
      </div>
      <div style="margin-top:12px;text-align:left">
        <button class="btn btn-success" onclick="saveStocksSettings()">๐พ ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุฃุณูู</button>
      </div>
    </div>
  </div>

  <!-- โโ 5. ุงููุณุฎ ุงูุงุญุชูุงุทู โ 0% ููุฏ โโ -->
  <div class="settings-section">
    <div class="settings-section-header">๐งฐ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููุงูู โ 0% ููุฏ</div>
    <div class="settings-section-body">

      <div class="info-box blue" style="margin-bottom:16px">
        ๐ต <strong>ุงูุชุตุฏูุฑ:</strong> ููุตุฏูุฑ <strong>ูู</strong> ููุงุชูุญ localStorage ุฏูู ุงุณุชุซูุงุก โ
        ูุดูู ุชููุงุฆูุงู ูู ุตูุญุฉ ุญุงููุฉ ุฃู ูุณุชูุจููุฉ.
        <br>
        ๐ก <strong>ุงูุงุณุชุนุงุฏุฉ:</strong> ุชูุณุญ localStorage ุซู ุชูุนูุฏ ูู ููุชุงุญ ุจูููุชู ุงูุฃุตููุฉ โ ูุณุจุฉ ููุฏ ุตูุฑ.
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px">
        <button class="btn btn-primary" onclick="exportFullBackup()">
          ๐ฆ ุชุตุฏูุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุงููุฉ (JSON)
        </button>
        <label class="btn btn-warn" style="cursor:pointer">
          ๐ค ุงุฎุชูุงุฑ ููู ููุงุณุชุนุงุฏุฉ
          <input id="restoreInput" type="file" accept=".json" style="display:none"
                 onchange="handleRestoreFile(this)">
        </label>
        <button class="btn btn-danger btn-sm" onclick="clearSession()">๐ ูุณุญ sessionStorage</button>
        <button class="btn btn-danger btn-sm" onclick="clearLocalStorage()">๐ ูุณุญ localStorage ูุงููุงู</button>
      </div>

      <div id="backupFileInfo" style="display:none;margin-bottom:12px;padding:10px 14px;
           background:rgba(34,197,94,.07);border:1px solid rgba(34,197,94,.25);
           border-radius:8px;font-size:13px">
      </div>

      <div id="restoreBtnWrap" style="display:none;margin-bottom:16px">
        <button class="btn btn-danger" onclick="confirmRestore()">
          โป๏ธ ุงุณุชุนุงุฏุฉ ูุงููุฉ (ุณููุนุงุฏ ูู ุดูุก ููุง ูุงู)
        </button>
      </div>

      <div style="font-size:13px;font-weight:700;color:var(--text2);margin-bottom:10px">
        ๐ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุญุงููุงู ูู localStorage:
      </div>
      <div id="sessionStatus"
           style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px">
      </div>

    </div>
  </div>

</div>

<script>
let _pendingRestore = null;

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  1. ุฅุนุฏุงุฏุงุช ุนุงูุฉ
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function loadSettings() {
  const s = Store.load('app_settings_v1', APP.settings);
  const f = Store.load('app_fees_v1',     APP.fees);
  document.getElementById('s-ownerName').value       = s.ownerName        || APP.settings.ownerName       || '';
  document.getElementById('s-retirementYear').value  = s.retirementYear   || APP.settings.retirementYear;
  document.getElementById('s-targetCapital').value   = s.targetCapital    || APP.settings.targetCapital;
  document.getElementById('s-targetYield').value     = ((s.targetYield    || APP.settings.targetYield)*100).toFixed(2);
  document.getElementById('s-commissionRate').value  = ((f.commissionRate || APP.fees.commissionRate)*100).toFixed(4);
  document.getElementById('s-vatRate').value         = ((f.vatRate        || APP.fees.vatRate)*100).toFixed(0);
  document.getElementById('s-minCommission').value   = f.minCommission    ?? APP.fees.minCommission;
  document.getElementById('s-maxPositionPct').value  = ((s.maxPositionPct || APP.settings.maxPositionPct)*100).toFixed(0);
  document.getElementById('s-maxSectorPct').value    = ((s.maxSectorPct   || APP.settings.maxSectorPct)*100).toFixed(0);
  document.getElementById('s-blueChipMaxPct').value  = ((s.blueChipMaxPct || APP.settings.blueChipMaxPct)*100).toFixed(0);
  document.getElementById('s-minPositions').value    = s.minPositions     || APP.settings.minPositions;
  document.getElementById('s-maxPositions').value    = s.maxPositions     || APP.settings.maxPositions;
  document.getElementById('s-rebalanceThresh').value = ((s.rebalanceThresh|| APP.settings.rebalanceThresh)*100).toFixed(0);
}

function saveAll() {
  const newSettings = {
    ownerName:       document.getElementById('s-ownerName').value,
    retirementYear:  parseInt(document.getElementById('s-retirementYear').value),
    targetCapital:   parseFloat(document.getElementById('s-targetCapital').value),
    targetYield:     parseFloat(document.getElementById('s-targetYield').value)/100,
    maxPositionPct:  parseFloat(document.getElementById('s-maxPositionPct').value)/100,
    maxSectorPct:    parseFloat(document.getElementById('s-maxSectorPct').value)/100,
    blueChipMaxPct:  parseFloat(document.getElementById('s-blueChipMaxPct').value)/100,
    minPositions:    parseInt(document.getElementById('s-minPositions').value),
    maxPositions:    parseInt(document.getElementById('s-maxPositions').value),
    rebalanceThresh: parseFloat(document.getElementById('s-rebalanceThresh').value)/100,
  };
  const newFees = {
    commissionRate: parseFloat(document.getElementById('s-commissionRate').value)/100,
    vatRate:        parseFloat(document.getElementById('s-vatRate').value)/100,
    minCommission:  parseFloat(document.getElementById('s-minCommission').value)||0,
  };
  Object.assign(APP.settings, newSettings);
  Object.assign(APP.fees,     newFees);
  Store.save('app_settings_v1', newSettings);
  Store.save('app_fees_v1',     newFees);
  toast('โ ุชู ุงูุญูุธ โ ุงูุฅุนุฏุงุฏุงุช ููุนููุฉ ุงูุขู','success');
  renderSessionStatus();
}

function resetAll() {
  if (!confirm('ุงุณุชุนุงุฏุฉ ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉุ')) return;
  Store.save('app_settings_v1', APP.settings);
  Store.save('app_fees_v1',     APP.fees);
  loadSettings();
  toast('๐ ุชูุช ุงูุงุณุชุนุงุฏุฉ','warn');
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  2. ุฅุนุฏุงุฏุงุช ุงูุฃุณูู โ ูุณุชุฎุฏู H.tickerName(p.ticker)
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function loadStocksSettings() {
  const port = Store.load('portfolio_v1', APP.portfolio);
  const decisions = ['ุชุฌููุน','ุงุญุชูุงุธ','ูุฑุงูุจุฉ','ุชุฎููู','ุจูุน'];
  document.getElementById('stocksSettingsBody').innerHTML = port.map((p,i) => `
    <tr>
      <td style="font-weight:600">${H.tickerName(p.ticker)}</td>
      <td class="accent">${p.ticker}</td>
      <td><input class="field-inline" style="width:70px;text-align:center" id="sp-goal-${i}"  type="number" step="0.1"    value="${(p.goal_alloc*100).toFixed(1)}"></td>
      <td><input class="field-inline" style="width:80px;text-align:center" id="sp-buy-${i}"   type="number" step="0.01"   value="${p.buy_zone_max}"></td>
      <td><input class="field-inline" style="width:80px;text-align:center" id="sp-sellL-${i}" type="number" step="0.01"   value="${p.sell_zone_low}"></td>
      <td><input class="field-inline" style="width:80px;text-align:center" id="sp-sellH-${i}" type="number" step="0.01"   value="${p.sell_zone_high}"></td>
      <td>
        <select class="field-inline" style="width:100px" id="sp-dec-${i}">
          ${decisions.map(d => `<option ${d===p.decision?'selected':''}>${d}</option>`).join('')}
        </select>
      </td>
      <td><input class="field-inline" style="width:160px" id="sp-eval-${i}" type="text" value="${p.eval || ''}"></td>
    </tr>
  `).join('');
}

function saveStocksSettings() {
  const port = Store.load('portfolio_v1', APP.portfolio);
  port.forEach((p,i) => {
    p.goal_alloc     = parseFloat(document.getElementById(`sp-goal-${i}`).value)/100  || p.goal_alloc;
    p.buy_zone_max   = parseFloat(document.getElementById(`sp-buy-${i}`).value)        || p.buy_zone_max;
    p.sell_zone_low  = parseFloat(document.getElementById(`sp-sellL-${i}`).value)      || p.sell_zone_low;
    p.sell_zone_high = parseFloat(document.getElementById(`sp-sellH-${i}`).value)      || p.sell_zone_high;
    p.decision       = document.getElementById(`sp-dec-${i}`).value;
    p.eval           = document.getElementById(`sp-eval-${i}`).value;
  });
  Store.save('portfolio_v1', port);
  toast('โ ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุฃุณูู ูุชุญุฏูุซ ุงููุญูุธุฉ','success');
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  3. ุงููุณุฎ ุงูุงุญุชูุงุทู
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function exportFullBackup() {
  const lsData = {};
  for (let i = 0; i < localStorage.length; i++) {
    const k = localStorage.key(i);
    lsData[k] = localStorage.getItem(k);
  }
  const payload = {
    app:        '2043',
    version:    2,
    exportedAt: new Date().toISOString(),
    keysCount:  Object.keys(lsData).length,
    localStorage: lsData
  };
  const json = JSON.stringify(payload, null, 2);
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([json], { type: 'application/json' }));
  a.download = `2043_full_backup_${new Date().toISOString().slice(0,10)}.json`;
  a.click();
  toast(`๐ฆ ุชู ุงูุชุตุฏูุฑ โ ${Object.keys(lsData).length} ุนูุตุฑ ูุญููุธ`, 'success');
  renderSessionStatus();
}

function handleRestoreFile(input) {
  const file = input.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const obj = JSON.parse(reader.result);
      if (obj.version === 2 && obj.localStorage && typeof obj.localStorage === 'object') {
        _pendingRestore = { type: 'v2', data: obj };
      } else if (!obj.version && typeof obj === 'object') {
        _pendingRestore = { type: 'v1', data: obj };
      } else {
        toast('ููู ุบูุฑ ุตุงูุญ ุฃู ุชูุณูู ุบูุฑ ูุนุฑูู', 'error');
        return;
      }
      const count = _pendingRestore.type === 'v2'
        ? Object.keys(obj.localStorage).length
        : Object.keys(obj).filter(k => !k.startsWith('_')).length;
      const info = document.getElementById('backupFileInfo');
      info.style.display = 'block';
      info.innerHTML = `
        โ <strong>ุงูููู ูุญููู ุจูุฌุงุญ</strong><br>
        ๐ ุชุงุฑูุฎ ุงููุณุฎุฉ: <strong>${(obj.exportedAt || obj._exported || 'โ').split('T')[0]}</strong><br>
        ๐ ุนุฏุฏ ุงูุนูุงุตุฑ: <strong>${count}</strong><br>
        ๐ฆ ุงูุฅุตุฏุงุฑ: <strong>${obj.version || 'v1 ูุฏูู'}</strong>
      `;
      document.getElementById('restoreBtnWrap').style.display = 'block';
      toast('โ ููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุฌุงูุฒ ููุงุณุชุนุงุฏุฉ','success');
    } catch (e) {
      toast('ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู โ ุชุฃูุฏ ุฃูู JSON ุตุงูุญ','error');
    }
  };
  reader.readAsText(file);
}

function confirmRestore() {
  if (!_pendingRestore) return toast('ุงุฎุชุฑ ููู ุงูุงุณุชุนุงุฏุฉ ุฃููุงู','error');
  if (!confirm('โ๏ธ ุณูุชู ูุณุญ ูู ุงูุจูุงูุงุช ุงูุญุงููุฉ ูุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ.\nูุฐุง ูุง ูููู ุงูุชุฑุงุฌุน ุนูู. ูู ุฃูุช ูุชุฃูุฏุ')) return;
  localStorage.clear();
  if (_pendingRestore.type === 'v2') {
    const lsData = _pendingRestore.data.localStorage;
    Object.keys(lsData).forEach(k => localStorage.setItem(k, lsData[k]));
  } else {
    const obj = _pendingRestore.data;
    Object.keys(obj).forEach(k => {
      if (!k.startsWith('_')) {
        const val = typeof obj[k] === 'string' ? obj[k] : JSON.stringify(obj[k]);
        localStorage.setItem(k, val);
      }
    });
  }
  toast('โป๏ธ ุชูุช ุงูุงุณุชุนุงุฏุฉ ุจุงููุงูู โ ุฌุงุฑู ุฅุนุงุฏุฉ ุงูุชุญููู','success');
  setTimeout(() => location.reload(), 1000);
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  4. ูุณุญ
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function clearSession() {
  if (!confirm('ูุณุญ sessionStorageุ ุงูุจูุงูุงุช ูู localStorage ุณุชุจูู.')) return;
  try { sessionStorage.clear(); } catch(e) {}
  toast('๐ ุชู ูุณุญ sessionStorage','warn');
  setTimeout(() => location.reload(), 1000);
}

function clearLocalStorage() {
  if (!confirm('โ๏ธ ูุณุญ ูู localStorageุ\n\nุณุชูุญุฐู ุฌููุน ุงูุจูุงูุงุช ูุชุนูุฏ ูู data.js.\nุตุฏูุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฃููุงู!')) return;
  try { localStorage.clear(); } catch(e) {}
  toast('๐ ุชู ูุณุญ localStorage โ ุฅุนุงุฏุฉ ุงูุชุญููู','warn');
  setTimeout(() => location.reload(), 1000);
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  5. ุญุงูุฉ localStorage
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
function renderSessionStatus() {
  const container = document.getElementById('sessionStatus');
  if (!localStorage.length) {
    container.innerHTML = '<p style="color:var(--text3);font-size:13px">localStorage ูุงุฑุบ โ ูู ุงูุจูุงูุงุช ุชุฃุชู ูู data.js</p>';
    return;
  }
  const keys = [];
  for (let i = 0; i < localStorage.length; i++) keys.push(localStorage.key(i));
  keys.sort();
  const labels = {
    'portfolio_v1':     'ุงููุญูุธุฉ',
    'transactions_v1':  'ุงูุนูููุงุช',
    'dividends_v1':     'ุงูุชูุฒูุนุงุช',
    'cashinvest_v1':    'ุงูุณูููุฉ ููุถุฎ',
    'networth_full_v1': 'ุตุงูู ุงูุซุฑูุฉ',
    'properties_v1':    'ุงูุนูุงุฑุงุช',
    'app_settings_v1':  'ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ',
    'app_fees_v1':      'ุงูุนูููุงุช',
    'salary_v1':        'ุณุฌูุงุช ุงูุฑุงุชุจ',
    'salary_scale_v1':  'ุณูู ุงูุฑูุงุชุจ',
    'custom_tickers':   'ุชููุฑุงุช ูุฎุตุตุฉ',
    'forecast_v1':      'ุงูุชููุนุงุช',
  };
  container.innerHTML = keys.map(k => {
    const raw = localStorage.getItem(k);
    let sizeKB = (new Blob([raw]).size / 1024).toFixed(1);
    let count  = '';
    try {
      const parsed = JSON.parse(raw);
      if (Array.isArray(parsed)) count = ` โข ${parsed.length} ุนูุตุฑ`;
    } catch(e) {}
    return `
      <div style="padding:10px 14px;background:var(--bg2);border:1px solid rgba(34,197,94,.3);
                  border-radius:8px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px">
          <span style="font-size:13px;font-weight:600">${labels[k] || k}</span>
          <span style="font-size:10px;color:var(--green);font-weight:700">โ</span>
        </div>
        <div style="font-size:11px;color:var(--text3)">${sizeKB} KB${count}</div>
        ${k !== (labels[k] || k) ? `<div style="font-size:10px;color:var(--text3);margin-top:2px;font-family:monospace">${k}</div>` : ''}
      </div>`;
  }).join('');
}

// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
//  Init
// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
loadSettings();
loadStocksSettings();
renderSessionStatus();
</script>
</body>
</html>