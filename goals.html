<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<link rel="icon" href="data:,">
<title>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù â€” 2043</title>
<link rel="stylesheet" href="assets/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="assets/tickers.js"></script>
<script src="assets/data.js"></script>
<script src="assets/auth.js"></script>
<script src="assets/data-sync.js"></script>
<style>
.goal-card {
  background:var(--card); border:1px solid var(--border);
  border-radius:var(--radius); padding:24px; margin-bottom:16px;
}
.goal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
.goal-name { font-size:18px; font-weight:700; }
.goal-status {
  padding:5px 12px; border-radius:12px; font-size:11px;
  font-weight:600; text-transform:uppercase;
}
.goal-status.active { background:rgba(16,185,129,.15); color:#10b981; }
.goal-status.completed { background:rgba(99,102,241,.15); color:#6366f1; }
.goal-status.paused { background:rgba(245,158,11,.15); color:#f59e0b; }
.goal-info { font-size:13px; color:var(--text3); margin-bottom:12px; }
.goal-progress-bar {
  width:100%; height:12px; background:var(--bg2);
  border-radius:6px; overflow:hidden; margin-bottom:8px;
}
.goal-progress-fill {
  height:100%; background:linear-gradient(90deg, var(--accent) 0%, var(--accent-hover) 100%);
  transition:width .3s;
}
.goal-footer { display:flex; justify-content:space-between; align-items:center; }
.goal-amount { font-size:16px; font-weight:700; }
.goal-actions { display:flex; gap:6px; }
</style>
</head>
<body>
<script>initPage('goals');</script>

<div class="main">

  <div class="page-header">
    <div class="page-header-left">
      <h1>ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>
      <p>Ø­Ø¯Ø¯ Ø£Ù‡Ø¯Ø§ÙÙƒ ÙˆØªØªØ¨Ø¹ ØªÙ‚Ø¯Ù…Ùƒ</p>
    </div>
    <div class="page-header-right">
      <button class="btn btn-primary btn-sm" onclick="saveAll()">ğŸ’¾ Ø­ÙØ¸</button>
    </div>
  </div>

  <div class="kpi-grid cols-4" id="goalsKPIs"></div>

  <div class="form-card">
    <h3>â• Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯</h3>
    <div class="form-row">
      <div class="form-group">
        <label>Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù</label>
        <input id="g-name" placeholder="Ø´Ø±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø©">
      </div>
      <div class="form-group">
        <label>Ø§Ù„ÙØ¦Ø©</label>
        <select id="g-category">
          <option value="Ø´Ø®ØµÙŠ">Ø´Ø®ØµÙŠ</option>
          <option value="Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ">Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ</option>
          <option value="Ø¹Ø§Ø¦Ù„ÙŠ">Ø¹Ø§Ø¦Ù„ÙŠ</option>
          <option value="ØªØ¹Ù„ÙŠÙ…ÙŠ">ØªØ¹Ù„ÙŠÙ…ÙŠ</option>
          <option value="ØµØ­ÙŠ">ØµØ­ÙŠ</option>
          <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
        </select>
      </div>
      <div class="form-group">
        <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Ø±.Ø³)</label>
        <input id="g-target" type="number" step="1000" placeholder="150000">
      </div>
      <div class="form-group">
        <label>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø±.Ø³)</label>
        <input id="g-current" type="number" step="100" placeholder="50000">
      </div>
      <div class="form-group">
        <label>Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</label>
        <input id="g-deadline" type="date">
      </div>
      <div class="form-group">
        <label>Ø§Ù„Ø­Ø§Ù„Ø©</label>
        <select id="g-status">
          <option value="active">Ù†Ø´Ø·</option>
          <option value="paused">Ù…ØªÙˆÙ‚Ù</option>
          <option value="completed">Ù…ÙƒØªÙ…Ù„</option>
        </select>
      </div>
    </div>
    <div class="form-group">
      <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
      <textarea id="g-notes" rows="2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
    </div>
    <button class="btn btn-primary" onclick="addGoal()">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>

  <div class="chart-card">
    <div class="chart-title">ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</div>
    <div id="goalsList"></div>
  </div>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  State
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let goals = [];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Init
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init() {
  goals = APP.goals;
  renderKPIs();
  renderList();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  KPIs
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderKPIs() {
  const total = goals.length;
  const active = goals.filter(g => g.status === 'active').length;
  const completed = goals.filter(g => g.status === 'completed').length;
  const totalTarget = goals.reduce((s, g) => s + (parseFloat(g.target) || 0), 0);

  const kpis = [
    { label:'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù',   value:total.toString(),              icon:'ğŸ¯' },
    { label:'Ø§Ù„Ù†Ø´Ø·',            value:active.toString(),             icon:'âœ…' },
    { label:'Ø§Ù„Ù…ÙƒØªÙ…Ù„',          value:completed.toString(),          icon:'ğŸ†' },
    { label:'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù',  value:H.fmt(totalTarget, 0) + ' Ø±.Ø³', icon:'ğŸ’°' }
  ];

  document.getElementById('goalsKPIs').innerHTML = kpis.map(k => `
    <div class="kpi-card">
      <div class="kpi-icon">${k.icon}</div>
      <div class="kpi-value">${k.value}</div>
      <div class="kpi-label">${k.label}</div>
    </div>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Add Goal
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addGoal() {
  const name = document.getElementById('g-name').value.trim();
  const category = document.getElementById('g-category').value;
  const target = parseFloat(document.getElementById('g-target').value) || 0;
  const current = parseFloat(document.getElementById('g-current').value) || 0;
  const deadline = document.getElementById('g-deadline').value;
  const status = document.getElementById('g-status').value;
  const notes = document.getElementById('g-notes').value.trim();

  if (!name || !target) {
    toast('âš ï¸ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'warn');
    return;
  }

  const newGoal = {
    id: Date.now(),
    name,
    category,
    target,
    current,
    deadline,
    status,
    notes
  };

  goals.push(newGoal);

  // Clear
  document.getElementById('g-name').value = '';
  document.getElementById('g-target').value = '';
  document.getElementById('g-current').value = '';
  document.getElementById('g-deadline').value = '';
  document.getElementById('g-notes').value = '';

  saveAll();
  init();
  toast('âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  List
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderList() {
  const list = document.getElementById('goalsList');

  if (!goals.length) {
    list.innerHTML = '<p style="text-align:center;color:var(--text3);padding:40px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‡Ø¯Ø§Ù</p>';
    return;
  }

  list.innerHTML = goals.map(g => {
    const progress = g.target > 0 ? (g.current / g.target * 100) : 0;
    const progressClamped = Math.min(progress, 100);
    
    const statusLabels = {
      active: 'Ù†Ø´Ø·',
      completed: 'Ù…ÙƒØªÙ…Ù„',
      paused: 'Ù…ØªÙˆÙ‚Ù'
    };

    return `
      <div class="goal-card">
        <div class="goal-header">
          <div class="goal-name">${g.name}</div>
          <div class="goal-status ${g.status}">${statusLabels[g.status]}</div>
        </div>
        <div class="goal-info">
          ${g.category} â€¢ Ø§Ù„Ù…ÙˆØ¹Ø¯: ${g.deadline || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
        </div>
        <div class="goal-progress-bar">
          <div class="goal-progress-fill" style="width:${progressClamped}%"></div>
        </div>
        <div class="goal-footer">
          <div class="goal-amount">
            ${H.fmt(g.current, 0)} / ${H.fmt(g.target, 0)} Ø±.Ø³ (${progress.toFixed(1)}%)
          </div>
          <div class="goal-actions">
            <button class="btn btn-ghost btn-xs" onclick="updateGoal(${g.id})">ğŸ’µ</button>
            <button class="btn btn-ghost btn-xs" onclick="editGoal(${g.id})">âœï¸</button>
            <button class="btn btn-danger btn-xs" onclick="deleteGoal(${g.id})">ğŸ—‘ï¸</button>
          </div>
        </div>
      </div>
    `;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Update Goal
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateGoal(id) {
  const g = goals.find(gl => gl.id === id);
  if (!g) return;

  const newCurrent = prompt(`ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù€ "${g.name}":`, g.current);
  if (newCurrent === null || isNaN(newCurrent)) return;

  g.current = parseFloat(newCurrent);

  saveAll();
  init();
  toast('âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Edit Goal
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function editGoal(id) {
  const g = goals.find(gl => gl.id === id);
  if (!g) return;

  const newStatus = prompt(`ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© "${g.name}" (active/paused/completed):`, g.status);
  if (!newStatus) return;

  if (['active', 'paused', 'completed'].includes(newStatus)) {
    g.status = newStatus;
    saveAll();
    init();
    toast('âœ… ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
  } else {
    toast('âš ï¸ Ø­Ø§Ù„Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'warn');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Delete Goal
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function deleteGoal(id) {
  if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯ÙØŸ')) return;

  goals = goals.filter(g => g.id !== id);

  saveAll();
  init();
  toast('âœ… ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Save
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveAll() {
  Store.save('goals_v1', goals);
  toast('âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­', 'success');
  dataSync.emit('goals');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Sync
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
dataSync.onDataChanged('goals', init);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Run
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
init();
</script>

</body>
</html>
